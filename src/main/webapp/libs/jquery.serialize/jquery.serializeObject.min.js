"use strict";
(function($){
    $.fn.serializeObject = function () {
        var result = {};
        this.find("select").each(function(i,element){
        	var key = $(this).attr('data-key') || $(this).attr('name');
            var node = result[key];
            if ('undefined' !== typeof node && node !== null) {
                if ($.isArray(node)) {
                    node.push(element.value);
                } else {
                    result[key] = [node, element.value];
                }
            } else {
                result[key] = element.value;
            }
        });
        this.find("input[type!='radio'][type!='checkbox']").each(function(i,element){
        	var key = $(this).attr('data-key') || $(this).attr('name');
            var node = result[key];
            if ('undefined' !== typeof node && node !== null) {
                if ($.isArray(node)) {
                    node.push(element.value);
                } else {
                    result[key] = [node, element.value];
                }
            } else {
                result[key] = element.value;
            }
        });
        this.find("input[type = 'radio']:checked").each(function(i,element){
        	var key = $(this).attr('data-key') || $(this).attr('name');
            var node = result[key];
            var value = element.value;
            if(value == "on" || value == "checked")
                value = true;
            if ('undefined' !== typeof node && node !== null) {
                if ($.isArray(node)) {
                    node.push(value);
                } else {
                    result[key] = [node, value];
                }
            } else {
                result[key] = value;
            }
        });
        this.find("input[type = 'checkbox']:checked").each(function(i,element){
        	var key = $(this).attr('data-key') || $(this).attr('name');
            var node = result[key];
            var value = element.value;
            if(value == "on" || value == "checked")
                value = true;
            if ('undefined' !== typeof node && node !== null) {
                if ($.isArray(node)) {
                    node.push(value);
                } else {
                    result[key] = [node, value];
                }
            } else {
                result[key] = value;
            }        
        });
        this.find("textarea").each(function(i,element){
        	var key = $(this).attr('data-key') || $(this).attr('name');
            var node = result[key];
            if ('undefined' !== typeof node && node !== null) {
                if ($.isArray(node)) {
                    node.push(element.value);
                } else {
                    result[key] = [node, element.value];
                }
            } else {
                result[key] = element.value;
            }
        });
        return result;
    };
})(jQuery);


(function($){
    $.fn.deSerializeObject = function (obj) {
        this.find("input[type!='radio'][type!='checkbox']").each(function(idx,domElement){
        	var key = $(this).attr('data-key') || $(this).attr('name');
            if(key && !$(this).hasClass('exculde'))
                $(domElement).val(obj[key] == undefined ? "" : htmlDecode(obj[key]));
        });
        this.find('select').each(function(idx,domElement){
        	var key = $(this).attr('data-key') || $(this).attr('name');
            if(key && !$(this).hasClass('exculde'))
                $(domElement).val(obj[key] == undefined ? "" : htmlDecode(obj[key]));
        });
        this.find('textarea').each(function(idx,domElement){
        	var key = $(this).attr('data-key') || $(this).attr('name');
            if(key && !$(this).hasClass('exculde'))
                $(domElement).val(obj[key] == undefined ? "" : htmlDecode(obj[key]));
        });
        this.find("input[type = 'radio']").each(function(idx,domElement){
        	var key = $(this).attr('data-key') || $(this).attr('name');
            if(key && !$(this).hasClass('exculde'))
            	 $(domElement).prop('checked', obj[key] == $(domElement).val());
        });
        this.find("input[type = 'checkbox']").each(function(idx,domElement){
        	var key = $(this).attr('data-key') || $(this).attr('name');
            if(key && !$(this).hasClass('exculde'))
                $(domElement).prop('checked', (obj[key] == undefined ? "" : obj[key]).indexOf($(domElement).val()) != -1);
        });
        
        return this;
    };
})(jQuery);